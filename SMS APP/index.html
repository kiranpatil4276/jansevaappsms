<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Registration Form</title>
    <link rel="manifest" href="manifest.json" />
    <meta name="theme-color" content="#3f51b5" />
    <link rel="icon" href="android-launchericon-192-192.png" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />

    <style>
      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      body {
        font-family: "Segoe UI", sans-serif;
        background: #eaf0f9ec;
        color: #333;
      }

      /* üåê Navbar */
      .navbar {
        background: linear-gradient(to right, #1a237e, #03adec);
        color: white;
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 12px 24px;
        flex-wrap: wrap;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
        position: sticky;
        top: 0;
        z-index: 1000;
      }

      .navbar .logo {
        display: flex;
        align-items: center;
      }

      .navbar .logo img {
        height: 50px;
        margin-right: 10px;
        border-radius: 8px;
        box-shadow: 0 0 6px rgba(0, 0, 0, 0.2);
      }

      .navbar .title {
        font-size: 1.9rem;
        font-weight: 800;
        text-align: center;
        flex: 1;
        font-family: "Segoe UI", sans-serif;
      }

      .navbar .install-btn {
        background: #e67514;
        border: none;
        color: white;
        padding: 10px 14px;
        font-size: 18px;
        border-radius: 50%;
        cursor: pointer;
        transition: background 0.3s ease;
      }

      .navbar .install-btn:hover {
        background: #ffffff44;
      }

      /* Responsive tweaks */
      @media (max-width: 600px) {
        .navbar {
          flex-direction: column;
          text-align: center;
          gap: 10px;
        }

        .navbar .title {
          margin-top: 10px;
        }

        .navbar .install-btn {
          border-radius: 30px;
          padding: 8px 16px;
          font-size: 14px;
        }
      }

      /* üßæ Form */
      .form-container {
        background: white;
        max-width: 500px;
        margin: 40px auto;
        padding: 30px;
        border-radius: 12px;
        box-shadow: 0 4px 22px rgba(0, 0, 0, 0.4);
      }

      .form-container h2 {
        text-align: center;
        margin-bottom: 20px;
        color: #3f51b5;
      }

      .form-container input {
        width: 100%;
        padding: 12px;
        margin: 10px 0;
        border: 1px solid #ccc;
        border-radius: 6px;
        font-size: 14px;
      }

      .form-container button {
        width: 100%;
        background: linear-gradient(to right, #2196f3, #0d47a1);
        color: white;
        border: none;
        padding: 14px;
        font-size: 16px;
        border-radius: 30px;
        cursor: pointer;
        margin-top: 10px;
      }

      .form-container button:hover {
        background: linear-gradient(to right, #0d47a1, #2196f3);
      }

      label {
        display: block;
        margin-top: 15px;
        font-weight: 500;
        color: #444;
      }

      .toast {
        display: none;
        margin-top: 20px;
        padding: 14px;
        background-color: #4caf50;
        color: white;
        text-align: center;
        border-radius: 8px;
        font-size: 15px;
        animation: fadeInOut 3s ease-in-out;
      }

      @keyframes fadeInOut {
        0% {
          opacity: 0;
          transform: translateY(10px);
        }

        10% {
          opacity: 1;
          transform: translateY(0);
        }

        90% {
          opacity: 1;
          transform: translateY(0);
        }

        100% {
          opacity: 0;
          transform: translateY(-10px);
        }
      }

      @media (max-width: 600px) {
        .navbar {
          flex-direction: column;
          text-align: center;
        }

        .navbar .title {
          margin: 10px 0;
        }
      }

      /* üîò Styled Radio Buttons */
      .radio-group {
        display: flex;
        gap: 30px;
        align-items: center;
        margin: 10px 0 20px 0;
      }

      .radio-option {
        display: flex;
        align-items: center;
        font-size: 15px;
        color: #333;
      }

      .radio-option input[type="radio"] {
        margin-right: 8px;
        accent-color: #3f51b5;
        transform: scale(1.3);
        cursor: pointer;
      }

      @media (max-width: 600px) {
        .radio-group {
          flex-direction: column;
          align-items: flex-start;
          gap: 10px;
        }
      }

      /* üîÑ Loader Overlay */
      .loader-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(255, 255, 255, 0.85);
        z-index: 9999;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
      }

      /* üåÄ Spinner Circle */
      .spinner {
        width: 60px;
        height: 60px;
        border: 6px solid #ddd;
        border-top: 6px solid #3f51b5;
        border-radius: 50%;
        animation: spin 1s linear infinite;
      }

      /* ‚è≥ Optional Text */
      .loader-text {
        margin-top: 15px;
        font-size: 1.1rem;
        color: #3f51b5;
        font-weight: 500;
        font-family: Arial, sans-serif;
        animation: fadeIn 1s ease-in-out infinite alternate;
      }

      /* üîÅ Keyframes */
      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }

      @keyframes fadeIn {
        from {
          opacity: 0.4;
        }
        to {
          opacity: 1;
        }
      }
    </style>
  </head>

  <body>
    <!-- üöÄ Navbar -->
    <div class="navbar">
      <div class="logo">
        <img
          src="./logo/WhatsApp Image 2025-07-05 at 20.55.29_ac21f277.png"
          alt="Logo"
        />
      </div>
      <div class="title">‡§ú‡§®‡§ï‡§≤‡•ç‡§Ø‡§æ‡§£ ‡§Ü‡§∞‡•ã‡§ó‡•ç‡§Ø ‡§∏‡•á‡§µ‡§æ</div>
     <div style="display: flex; gap: 10px; align-items: center;">
  <button
    id="adminBtn"
    class="install-btn"
    style="border-radius: 30px; padding: 8px 14px; display: block;"
    onclick="window.location.href='login.html'"
    title="Go to Admin Panel"
  >
    <i class="fas fa-user-shield"></i> Admin Panel
  </button>

  <button
    id="installBtn"
    class="install-btn"
    style="display: none"
    title="Install App"
  >
    <i class="fas fa-download"></i>
  </button>
</div>

    </div>

    <!-- üìù Registration Form -->
    <div class="form-container">
      <h2>Registration Form</h2>
      <form id="regForm">
        <label><i class="fa-solid fa-circle-user"></i> Name</label>
        <input type="text" name="name" placeholder="Enter Full Name" required />

        <label><i class="fa-solid fa-file"></i> File No</label>
        <input
          type="text"
          name="fileno"
          placeholder="Enter File Name"
          required
        />

        <label><i class="fa-solid fa-location-dot"></i> Address</label>
        <input
          type="text"
          name="address"
          placeholder="Enter Permanent Address"
          required
        />

        <label><i class="fa-solid fa-address-card"></i> Aadhar No.</label>
        <input
          type="text"
          name="aadhar"
          id="aadhar"
          placeholder="Enter Aadhar No."
          required
          pattern="\d{12}"
          maxlength="12"
          oninput="this.value = this.value.replace(/[^0-9]/g, '')"
        />

        <label><i class="fa-solid fa-phone-volume"></i> Mobile No.</label>
        <input
          type="text"
          name="mobile"
          id="mobile"
          placeholder="Enter Mobile No."
          required
          pattern="\d{10}"
          maxlength="10"
          oninput="this.value = this.value.replace(/[^0-9]/g, '')"
        />

        <label><i class="fa-solid fa-user-plus"></i> Age</label>
        <input type="number" name="age" placeholder="Enter Age" required />

        <label><i class="fa-solid fa-briefcase"></i> Occupation</label>
        <input
          type="text"
          name="occupation"
          placeholder="Enter Occupation"
          required
        />

        <label><i class="fa-solid fa-receipt"></i> Receipt</label>
        <input
          type="text"
          name="receipt"
          placeholder="Enter Receipt No."
          required
        />

        <label><i class="fa-solid fa-id-badge"></i> Referral ID</label>
        <input type="text" name="referral" placeholder="eg.Abhi9119" required />
        <label><i class="fa-solid fa-money-bill"></i> Payment Mode</label>
        <div class="radio-group">
          <label class="radio-option">
            <input
              type="radio"
              name="paymentMode"
              value="cash"
              onchange="toggleQRCode(false)"
            />
            Cash
          </label>
          <label class="radio-option">
            <input
              type="radio"
              name="paymentMode"
              value="online"
              checked
              onchange="toggleQRCode(true)"
            />
            Online
          </label>
          ¬†¬†¬†¬†¬†¬†
        </div>
        <div id="qrCodeField">
          <label><i class="fa-solid fa-qrcode"></i> QR Code</label><br />
          <img
            src="./logo/qr.jpeg"
            alt="Scan QR Code"
            style="width: 200px; height: auto"
          />
          ¬†¬†¬†¬†¬†¬†
        </div>

        <button type="submit">Submit</button>
      </form>

      <!-- ‚úÖ Success Notification -->
      <div id="toast" class="toast">‚úÖ Successfully Registered!</div>
    </div>
  </body>
  <script>
  // üì§ Form Submission
  document
    .getElementById("regForm")
    .addEventListener("submit", async function (e) {
      e.preventDefault();
      const form = e.target;
      const formData = new FormData(form);

      try {
        const response = await fetch(
          "https://script.google.com/macros/s/AKfycbwZ2lGpDiGdeBwz4I43oEl4jfZN21b0hhZ3Z39-ztgsq-dQRuusgxUS1KoEvwlK-NPY/exec",
          { method: "POST", body: formData }
        );
        const result = await response.json();

        if (result.status === "success") {
          const name = form.name.value;
          const mobile = form.mobile.value;
          const message = `Hi ${name}, your registration was successful!`;

          // ‚úÖ Send SMS
          await fetch("http://localhost:3000/send-sms", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ number: mobile, message: message }),
          });

          // ‚úÖ Store in localStorage
          const formValues = {
            name: name,
            fileNo: form.fileno.value,
            address: form.address.value,
            aadhar: form.aadhar.value,
            mobile: mobile,
            age: form.age.value,
            occupation: form.occupation.value,
            receipt: form.receipt.value,
            referral: form.referral.value,
            paymentMode: form.paymentMode.value,
          };
          localStorage.setItem("userDetail", JSON.stringify(formValues));

          // ‚úÖ Show Toast and Redirect
          const toast = document.getElementById("toast");
          toast.style.display = "block";
          setTimeout(() => {
            toast.style.display = "none";
            window.location.href = "userdetail.html"; // Redirect
          }, 2000); // Wait 2s before redirect
        } else {
          alert("‚ùå Something went wrong: " + result.message);
        }
      } catch (error) {
        alert("‚ùå Error submitting form: " + error.message);
      }
    });

  // üì≤ PWA Install Button
  let deferredPrompt;
  const installBtn = document.getElementById("installBtn");

  window.addEventListener("beforeinstallprompt", (e) => {
    e.preventDefault();
    deferredPrompt = e;
    installBtn.style.display = "block";
  });

  installBtn.addEventListener("click", async () => {
    if (deferredPrompt) {
      deferredPrompt.prompt();
      const { outcome } = await deferredPrompt.userChoice;
      if (outcome === "accepted") {
        console.log("‚úÖ App installed");
        installBtn.style.display = "none";
      } else {
        console.log("‚ùå App install declined");
      }
      deferredPrompt = null;
    }
  });

  // üîÅ QR Code Toggle
  function toggleQRCode(show) {
    const qrCodeField = document.getElementById("qrCodeField");
    const qrInput = qrCodeField.querySelector("input");

    if (show) {
      qrCodeField.style.display = "block";
      if (qrInput) qrInput.setAttribute("required", "true");
    } else {
      qrCodeField.style.display = "none";
      if (qrInput) {
        qrInput.removeAttribute("required");
        qrInput.value = "";
      }
    }
  }
</script>


  <!-- <script>

          document
            .getElementById("regForm")
            .addEventListener("submit", async function (e) {
              e.preventDefault();

              const form = e.target;
              const formData = new FormData(form); // Using FormData to avoid CORS preflight

              try {
                const response = await fetch(
                  "https://script.google.com/macros/s/AKfycbwZ2lGpDiGdeBwz4I43oEl4jfZN21b0hhZ3Z39-ztgsq-dQRuusgxUS1KoEvwlK-NPY/exec",
                  {
                    method: "POST",
                    body: formData,
                  }
                );

                const result = await response.json();
                if (result.status === "success") {
                  alert("Registration successful! SMS sent.");
                  form.reset();
                } else {
                  alert("Something went wrong: " + result.message);
                }
              } catch (error) {
                alert("Error submitting form: " + error.message);
              }
            });
          function sendSMS(number, message) {
            const apiKey =
              "HJi8wSaCrPVSMYLmNHvKnOFDAr17nUA2u59bmRzNnuaoAyRnQcUHGPruUFXp"; // Replace with your API key
            const senderId = "FSTSMS"; // Or your registered sender ID (optional in test mode)

            const payload = {
              sender_id: senderId,
              message: message,
              language: "english",
              route: "p", // 'p' = promotional, 't' = transactional
              numbers: number,
            };

            const options = {
              method: "post",
              contentType: "application/json",
              headers: {
                authorization: apiKey,
              },
              payload: JSON.stringify(payload),
            };

            UrlFetchApp.fetch("https://www.fast2sms.com/dev/bulkV2", options);
          }
        </script> -->
  <!-- </body>
    </html> -->
</html>
